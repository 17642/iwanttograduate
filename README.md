# Fall Detection System for Elderly Safety
**독거 노인 안전 관리를 위한 다중 모달 낙상 감지 시스템 (졸업 작품)**

본 레포지토리는 독거 노인 주거 환경에서의 사고 예방을 위한 낙상 감지 시스템의 핵심 모듈을 포함합니다. 음성 감지 모델의 하드웨어 가속, 센서 간 통신 인프라 구축, 그리고 영상 기반의 신체 포인트 추적 로직이 포함되어 있습니다.

---

## 1. CNN 기반 음성 위기 상황 감지 (`new_model/` etc..)
마이크를 통해 입력되는 음향 데이터를 실시간으로 분석하여 비명, 도움 요청 등 위기 상황을 감지합니다. 임베디드 환경에서의 추론 속도 최적화에 중점을 두었습니다.

* **모델 아키텍처**: PyTorch 기반의 CNN (Audio Classification)
* **하드웨어 가속**: Raspberry Pi와 **Hailo-8 AI HAT** 통합
* **최적화 과정**: PyTorch 모델을 Hailo 가속기 전용 포맷인 **HEF(Hailo Executable Format)**로 변환 및 양자화(Quantization) 수행
* **주요 구성**:
    * 학습 및 검증 데이터 전처리 스크립트
    * HEF 포팅을 위한 컴파일 스크립트
    * 실시간 마이크 입력 스트림 추론 엔진



---

## 2. 센서-RPI 통합 및 네트워크 인프라
레이더 센서의 보조 데이터와 Raspberry Pi 간의 안정적인 통신 인프라를 구축했습니다.

* **MQTT 통신**: 센서 노드와 게이트웨이(RPI) 간의 저지연 메시지 송수신 및 자동 응답 콜백 시스템 구현
* **네트워크 호환성 해결**: 
    * ESP32 모듈의 `nmcli` 기반 AP 접속 불안정 이슈 해결을 위해 Raspberry Pi 내에 `hostapd` 및 `dhcpd`를 활용한 전용 AP 생성 인프라 구축
    * 외부 네트워크와 독립된 센서 전용 로컬 네트워크 환경 설계

---

## 3. 신체 포인트 추적 및 서보 제어 (`fall_detect/`)
카메라를 활용한 객체 추적 및 낙상 판정 로직입니다. (Legacy 모듈)

* **객체 탐지**: **YOLOv3** 기반의 인체 키포인트 추출 및 위치 변동 수치 분석을 통한 낙상 판정
* **카메라 트래킹**: 인체를 프레임 중앙에 유지하기 위한 2자유도(X, Y축) 서보 모터 제어
* **PID 제어 알고리즘**: 서보 모터의 급격한 회전 및 오차를 최소화하기 위해 아래와 같은 PID 제어 수식을 적용하여 정밀 트래킹 구현

$$u(t) = K_p e(t) + K_i \int_{0}^{t} e(\tau) d\tau + K_d \frac{de(t)}{dt}$$



---

